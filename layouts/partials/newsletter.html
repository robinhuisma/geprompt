<div class="newsletter-box">
  <h3>Op de hoogte blijven van AI-ontwikkelingen?</h3>
  <p>Ontvang op werkdagen het relevantste AI-lunchnieuws in je inbox.</p>
  <form id="newsletter-form">
    <div class="newsletter-fields">
      <input type="text" name="firstName" placeholder="Voornaam" required>
      <input type="email" name="email" placeholder="E-mailadres" required>
      <button type="submit">Aanmelden</button>
    </div>
    <label class="newsletter-avg">
      <input type="checkbox" name="avg_consent" required>
      <span>Ik ga akkoord met het ontvangen van de nieuwsbrief waarvan ik de inhoud ZELF bepaal. Ik wil me altijd eenvoudig kunnen uitschrijven. Geprompt.nl deelt je gegevens NIET met derden.</span>
    </label>
  </form>
  <div id="newsletter-thanks" style="display:none;">
    <p>✅ Bedankt voor je aanmelding! Je ontvangt binnenkort de eerste nieuwsbrief.</p>
  </div>
  <div id="newsletter-error" style="display:none;">
    <p>⚠️ Er ging iets mis. Probeer het later opnieuw.</p>
  </div>
</div>

<script>
document.getElementById('newsletter-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  const form = this;
  const btn = form.querySelector('button');
  const firstName = form.querySelector('[name="firstName"]').value;
  const email = form.querySelector('[name="email"]').value;

  btn.disabled = true;
  btn.textContent = 'Bezig...';

  try {
    const res = await fetch('https://n8n.geprompt.nl/webhook/geprompt-subscribe', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ firstName, email })
    });

    if (res.ok) {
      form.style.display = 'none';
      document.getElementById('newsletter-thanks').style.display = 'block';
    } else {
      throw new Error('Server error');
    }
  } catch (err) {
    document.getElementById('newsletter-error').style.display = 'block';
    btn.disabled = false;
    btn.textContent = 'Aanmelden';
  }
});
</script>
